<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Dashboard Inventory</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<nav class="navbar navbar-dark bg-dark px-3">
  <span class="navbar-brand">Inventory System</span>
  <span class="text-white">
    Login sebagai: <strong><%= user.username %> (<%= user.role %>)</strong>
  </span>
</nav>

<div class="container mt-4">

  <% if (user.role === 'manager') { %>
    <a href="/items/add" class="btn btn-primary mb-3">+ Tambah Barang</a>
  <% } %>

  <table class="table table-bordered table-striped">
    <thead class="table-dark">
      <tr>
        <th>Nama Barang</th>
        <th>Kategori</th>
        <th>Harga</th>
        <th>Stok</th>
        <th>Min Stok</th>
        <th>Lokasi</th>
        <th>Aksi</th>
      </tr>
    </thead>
    <tbody>
      <% items.forEach(item => { %>
        <tr class="<%= item.stock_qty <= item.min_stock ? 'table-warning' : '' %>">
          <td><%= item.item_name %></td>
          <td><%= item.category %></td>
          <td>Rp <%= item.price %></td>
          <td><%= item.stock_qty %></td>
          <td><%= item.min_stock %></td>
          <td><%= item.storage_location %></td>
          <td>
            <a href="/items/edit/<%= item.id %>" class="btn btn-sm btn-warning">Edit</a>

            <% if (user.role === 'manager') { %>
              <form action="/items/delete/<%= item.id %>" method="POST" class="d-inline">
                <button class="btn btn-sm btn-danger"
                  onclick="return confirm('Discontinue barang ini?')">
                  Hapus
                </button>
              </form>
            <% } %>
          </td>
        </tr>
      <% }) %>
    </tbody>
  </table>

</div>

</body>
</html>
